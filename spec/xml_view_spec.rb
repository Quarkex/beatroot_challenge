require 'xml_view'
require 'json'

track_json = '{"track":{"id":2,"title":"Sweet Lorraine","full_title":"Sweet Lorraine (live at the O2)","subtitle":"live at the O2","mix_version":null,"searchable":true,"recording_token":null,"recording_file_name":null,"recording_custom_file_name":null,"bit_rate":null,"channels":null,"sample_rate":null,"codec":null,"duration":202,"created_at":"2018-06-27T18:57:14.169Z","updated_at":"2018-06-27T19:21:55.720Z","waveform":null,"sentiment":"neutral","musical_work_type":"track","inherit_parent_track_data":true,"playlists_count":0,"releases_count":1,"preview_start":null,"preview_duration":null,"url_token":"1a58ce9b-376b-4efe-ae7c-bb83f34f1590","distributable":false,"explicit":true,"parental_warning":"not_explicit","assign_isrc":false,"isrc":"GBG3H1000203","iswc":null,"prs_tunecode":null,"catalogue_number":null,"recording_territory":null,"recording_date":null,"publishing_territory":null,"publishing_date":null,"commissioning_territory":null,"key":" ","audio_rights":null,"one_stop_license":null,"rigths_public_notes":null,"bpm":0,"intensity":0,"lyrics":null,"notes":null,"comments":null,"cover":false,"represented_recording_rights":null,"represented_publishing_rights":null,"digital_rights":false,"digital_distribution_rights":false,"claim_digital_sales":false,"artist":{"id":8,"writer":false,"name":"Tony Crombie feat. Robert Robertson","key_name":null,"image_token":null,"image_colours":null,"tracks_count":1,"searchable":true,"created_at":"2018-06-27T19:01:21.004Z","updated_at":"2018-06-27T19:22:36.259Z","image_crop_x":0,"image_crop_y":0,"image_crop_width":0},"web_transcoding":null,"parent_track":null,"transcodings":[],"tag":{"id":1124,"primary":true,"score":100,"name":"Dance","classification":"genre"},"key_release":null,"covered":null,"variations":[],"publishers":[],"record_labels":[{"id":1,"territories":["AO","BF","BI","BJ","BW","CD","CF","CG","CI","CM","CV","DJ","DZ","EG","EH","ER","ET","GA","GH","GM","GN","GQ","GW","KE","KM","LR","LS","LY","MA","MG","ML","MR","MU","MW","MZ","NA","NE","NG","RE","RW","SC","SD","SH","SL","SN","SO","SS","ST","SZ","TD","TG","TN","TZ","UG","YT","ZA","ZM","ZW","AQ","BV","GS","HM","TF","AE","AF","AM","AZ","BD","BH","BN","BT","CC","CN","CX","HK","ID","IL","IN","IO","IQ","IR","JO","JP","KG","KH","KP","KR","KW","KZ","LA","LB","LK","MM","MN","MO","MV","MY","NP","OM","PH","PK","PS","QA","SA","SG","SY","TH","TJ","TL","TM","TR","TW","UZ","VN","YE","AD","AL","AT","AX","BA","BE","BG","BY","CH","CY","CZ","DE","DK","EE","ES","FI","FO","FR","GB","GE","GG","GI","GR","HR","HU","IE","IM","IS","IT","JE","LI","LT","LU","LV","MC","MD","ME","MK","MT","NL","NO","PL","PT","RO","RS","RU","SE","SI","SJ","SK","SM","UA","VA","AG","AI","AW","BB","BL","BM","BQ","BS","BZ","CA","CR","CU","CW","DM","DO","GD","GL","GP","GT","HN","HT","JM","KN","KY","LC","MF","MQ","MS","MX","NI","PA","PM","PR","SV","SX","TC","TT","US","VC","VG","VI","AS","AU","CK","FJ","FM","GU","KI","MH","MP","NC","NF","NR","NU","NZ","PF","PG","PN","PW","SB","TK","TO","TV","UM","VU","WF","WS","AR","BO","BR","CL","CO","EC","FK","GF","GY","PE","PY","SR","UY","VE"],"start_date":null,"end_date":null,"contract_type":null,"c_line":null,"p_line":"2010 Harrison James Music","name":"Harrison James Music","imprint":null}],"deals":[],"writers":[],"contributors":[{"id":1,"name":"Tony Crombie","direct":true,"roles":["Artist"],"pro":null,"ipi":null},{"id":2,"name":"Robert Robertson","direct":true,"roles":["FeaturedArtist"],"pro":null,"ipi":null},{"id":3,"name":"Bill Wallis","direct":true,"roles":["Mixer"],"pro":null,"ipi":null},{"id":4,"name":"Anna Watson","direct":true,"roles":["Producer"],"pro":null,"ipi":null},{"id":5,"name":"June Blane","direct":false,"roles":["Composer"],"pro":null,"ipi":null},{"id":6,"name":"Marty Ford","direct":false,"roles":["Lyricist"],"pro":null,"ipi":null},{"id":7,"name":"Philip Pike","direct":false,"roles":["Lyricist"],"pro":null,"ipi":null}],"tags":[{"id":1124,"primary":true,"score":100,"name":"Dance","classification":"genre"},{"id":2045,"primary":false,"score":50,"name":"Tech House","classification":"genre"}],"distribution_primary_genre":null,"distribution_alternate_genre":null}}'
track_xml = '<beatroot><track><id>2</id><title>Sweet Lorraine</title><full_title>Sweet Lorraine (live at the O2)</full_title><subtitle>live at the O2</subtitle><mix_version></mix_version><searchable>true</searchable><recording_token></recording_token><recording_file_name></recording_file_name><recording_custom_file_name></recording_custom_file_name><bit_rate></bit_rate><channels></channels><sample_rate></sample_rate><codec></codec><duration>202</duration><created_at>2018-06-27T18:57:14.169Z</created_at><updated_at>2018-06-27T19:21:55.720Z</updated_at><waveform></waveform><sentiment>neutral</sentiment><musical_work_type>track</musical_work_type><inherit_parent_track_data>true</inherit_parent_track_data><playlists_count>0</playlists_count><releases_count>1</releases_count><preview_start></preview_start><preview_duration></preview_duration><url_token>1a58ce9b-376b-4efe-ae7c-bb83f34f1590</url_token><distributable>false</distributable><explicit>true</explicit><parental_warning>not_explicit</parental_warning><assign_isrc>false</assign_isrc><isrc>GBG3H1000203</isrc><iswc></iswc><prs_tunecode></prs_tunecode><catalogue_number></catalogue_number><recording_territory></recording_territory><recording_date></recording_date><publishing_territory></publishing_territory><publishing_date></publishing_date><commissioning_territory></commissioning_territory><key> </key><audio_rights></audio_rights><one_stop_license></one_stop_license><rigths_public_notes></rigths_public_notes><bpm>0</bpm><intensity>0</intensity><lyrics></lyrics><notes></notes><comments></comments><cover>false</cover><represented_recording_rights></represented_recording_rights><represented_publishing_rights></represented_publishing_rights><digital_rights>false</digital_rights><digital_distribution_rights>false</digital_distribution_rights><claim_digital_sales>false</claim_digital_sales><artist><id>8</id><writer>false</writer><name>Tony Crombie feat. Robert Robertson</name><key_name></key_name><image_token></image_token><image_colours></image_colours><tracks_count>1</tracks_count><searchable>true</searchable><created_at>2018-06-27T19:01:21.004Z</created_at><updated_at>2018-06-27T19:22:36.259Z</updated_at><image_crop_x>0</image_crop_x><image_crop_y>0</image_crop_y><image_crop_width>0</image_crop_width></artist><web_transcoding></web_transcoding><parent_track></parent_track><transcodings></transcodings><tag><id>1124</id><primary>true</primary><score>100</score><name>Dance</name><classification>genre</classification></tag><key_release></key_release><covered></covered><variations></variations><publishers></publishers><record_labels><record_label><id>1</id><territories><territory>AO</territory><territory>BF</territory><territory>BI</territory><territory>BJ</territory><territory>BW</territory><territory>CD</territory><territory>CF</territory><territory>CG</territory><territory>CI</territory><territory>CM</territory><territory>CV</territory><territory>DJ</territory><territory>DZ</territory><territory>EG</territory><territory>EH</territory><territory>ER</territory><territory>ET</territory><territory>GA</territory><territory>GH</territory><territory>GM</territory><territory>GN</territory><territory>GQ</territory><territory>GW</territory><territory>KE</territory><territory>KM</territory><territory>LR</territory><territory>LS</territory><territory>LY</territory><territory>MA</territory><territory>MG</territory><territory>ML</territory><territory>MR</territory><territory>MU</territory><territory>MW</territory><territory>MZ</territory><territory>NA</territory><territory>NE</territory><territory>NG</territory><territory>RE</territory><territory>RW</territory><territory>SC</territory><territory>SD</territory><territory>SH</territory><territory>SL</territory><territory>SN</territory><territory>SO</territory><territory>SS</territory><territory>ST</territory><territory>SZ</territory><territory>TD</territory><territory>TG</territory><territory>TN</territory><territory>TZ</territory><territory>UG</territory><territory>YT</territory><territory>ZA</territory><territory>ZM</territory><territory>ZW</territory><territory>AQ</territory><territory>BV</territory><territory>GS</territory><territory>HM</territory><territory>TF</territory><territory>AE</territory><territory>AF</territory><territory>AM</territory><territory>AZ</territory><territory>BD</territory><territory>BH</territory><territory>BN</territory><territory>BT</territory><territory>CC</territory><territory>CN</territory><territory>CX</territory><territory>HK</territory><territory>ID</territory><territory>IL</territory><territory>IN</territory><territory>IO</territory><territory>IQ</territory><territory>IR</territory><territory>JO</territory><territory>JP</territory><territory>KG</territory><territory>KH</territory><territory>KP</territory><territory>KR</territory><territory>KW</territory><territory>KZ</territory><territory>LA</territory><territory>LB</territory><territory>LK</territory><territory>MM</territory><territory>MN</territory><territory>MO</territory><territory>MV</territory><territory>MY</territory><territory>NP</territory><territory>OM</territory><territory>PH</territory><territory>PK</territory><territory>PS</territory><territory>QA</territory><territory>SA</territory><territory>SG</territory><territory>SY</territory><territory>TH</territory><territory>TJ</territory><territory>TL</territory><territory>TM</territory><territory>TR</territory><territory>TW</territory><territory>UZ</territory><territory>VN</territory><territory>YE</territory><territory>AD</territory><territory>AL</territory><territory>AT</territory><territory>AX</territory><territory>BA</territory><territory>BE</territory><territory>BG</territory><territory>BY</territory><territory>CH</territory><territory>CY</territory><territory>CZ</territory><territory>DE</territory><territory>DK</territory><territory>EE</territory><territory>ES</territory><territory>FI</territory><territory>FO</territory><territory>FR</territory><territory>GB</territory><territory>GE</territory><territory>GG</territory><territory>GI</territory><territory>GR</territory><territory>HR</territory><territory>HU</territory><territory>IE</territory><territory>IM</territory><territory>IS</territory><territory>IT</territory><territory>JE</territory><territory>LI</territory><territory>LT</territory><territory>LU</territory><territory>LV</territory><territory>MC</territory><territory>MD</territory><territory>ME</territory><territory>MK</territory><territory>MT</territory><territory>NL</territory><territory>NO</territory><territory>PL</territory><territory>PT</territory><territory>RO</territory><territory>RS</territory><territory>RU</territory><territory>SE</territory><territory>SI</territory><territory>SJ</territory><territory>SK</territory><territory>SM</territory><territory>UA</territory><territory>VA</territory><territory>AG</territory><territory>AI</territory><territory>AW</territory><territory>BB</territory><territory>BL</territory><territory>BM</territory><territory>BQ</territory><territory>BS</territory><territory>BZ</territory><territory>CA</territory><territory>CR</territory><territory>CU</territory><territory>CW</territory><territory>DM</territory><territory>DO</territory><territory>GD</territory><territory>GL</territory><territory>GP</territory><territory>GT</territory><territory>HN</territory><territory>HT</territory><territory>JM</territory><territory>KN</territory><territory>KY</territory><territory>LC</territory><territory>MF</territory><territory>MQ</territory><territory>MS</territory><territory>MX</territory><territory>NI</territory><territory>PA</territory><territory>PM</territory><territory>PR</territory><territory>SV</territory><territory>SX</territory><territory>TC</territory><territory>TT</territory><territory>US</territory><territory>VC</territory><territory>VG</territory><territory>VI</territory><territory>AS</territory><territory>AU</territory><territory>CK</territory><territory>FJ</territory><territory>FM</territory><territory>GU</territory><territory>KI</territory><territory>MH</territory><territory>MP</territory><territory>NC</territory><territory>NF</territory><territory>NR</territory><territory>NU</territory><territory>NZ</territory><territory>PF</territory><territory>PG</territory><territory>PN</territory><territory>PW</territory><territory>SB</territory><territory>TK</territory><territory>TO</territory><territory>TV</territory><territory>UM</territory><territory>VU</territory><territory>WF</territory><territory>WS</territory><territory>AR</territory><territory>BO</territory><territory>BR</territory><territory>CL</territory><territory>CO</territory><territory>EC</territory><territory>FK</territory><territory>GF</territory><territory>GY</territory><territory>PE</territory><territory>PY</territory><territory>SR</territory><territory>UY</territory><territory>VE</territory></territories><start_date></start_date><end_date></end_date><contract_type></contract_type><c_line></c_line><p_line>2010 Harrison James Music</p_line><name>Harrison James Music</name><imprint></imprint></record_label></record_labels><deals></deals><writers></writers><contributors><contributor><id>1</id><name>Tony Crombie</name><direct>true</direct><roles><role>Artist</role></roles><pro></pro><ipi></ipi></contributor><contributor><id>2</id><name>Robert Robertson</name><direct>true</direct><roles><role>FeaturedArtist</role></roles><pro></pro><ipi></ipi></contributor><contributor><id>3</id><name>Bill Wallis</name><direct>true</direct><roles><role>Mixer</role></roles><pro></pro><ipi></ipi></contributor><contributor><id>4</id><name>Anna Watson</name><direct>true</direct><roles><role>Producer</role></roles><pro></pro><ipi></ipi></contributor><contributor><id>5</id><name>June Blane</name><direct>false</direct><roles><role>Composer</role></roles><pro></pro><ipi></ipi></contributor><contributor><id>6</id><name>Marty Ford</name><direct>false</direct><roles><role>Lyricist</role></roles><pro></pro><ipi></ipi></contributor><contributor><id>7</id><name>Philip Pike</name><direct>false</direct><roles><role>Lyricist</role></roles><pro></pro><ipi></ipi></contributor></contributors><tags><tag><id>1124</id><primary>true</primary><score>100</score><name>Dance</name><classification>genre</classification></tag><tag><id>2045</id><primary>false</primary><score>50</score><name>Tech House</name><classification>genre</classification></tag></tags><distribution_primary_genre></distribution_primary_genre><distribution_alternate_genre></distribution_alternate_genre></track></beatroot>'
track = JSON.parse track_json

RSpec.describe XML_View, "#render_track" do
    it "renders a track properly" do

      xml = XML_View.new("beatroot", {
        "contributors": "contributor",
        "record_labels": "record_label",
        "roles": "role",
        "tags": "tag",
        "territories": "territory",
      })

      output = xml.generate(track)

      expect(output).to eq track_xml

    end
end
